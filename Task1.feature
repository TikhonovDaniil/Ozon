@авторизация @авторизация.feature
Функция: Авторизация в приложении

@critical @positive
Сценарий: Я авторизуюсь с существующим логином и паролем
Пусть я открываю сайт "qa-testing.ru"
И заполняю форму логина валидными данными:
| элемент      | значение               |
| логин Email  | test1user@testmail.com |
| логин Пароль | "BAw23f5m"             |
И нажимаю "кнопку Войти"
Тогда я понимаю, что авторизован, так как вижу "профиль Пользователя"

@critical @negative
Сценарий: Я ввожу неверный пароль
Пусть я открываю сайт "qa-testing.ru"
И заполняю форму логина данными:
| элемент      | значение               |
| логин Email  | test1user@testmail.com |
| логин Пароль | "wrongpassword"        |
И нажимаю "кнопку Войти"
Тогда я вижу сообщение об ошибке "Неверный пароль"

@medium @negative
Сценарий: Я оставляю поле логина пустым
Пусть я открываю сайт "qa-testing.ru"
И заполняю форму логина данными:
| элемент      | значение    |
| логин Email  | ""          |
| логин Пароль | "BAw23f5m"  |
И нажимаю "кнопку Войти"
Тогда я вижу сообщение об ошибке "Поле логина не может быть пустым"

@medium @negative
Сценарий: Я оставляю поле пароля пустым
Пусть я открываю сайт "qa-testing.ru"
И заполняю форму логина данными:
| элемент      | значение               |
| логин Email  | test1user@testmail.com |
| логин Пароль | ""                     |
И нажимаю "кнопку Войти"
Тогда я вижу сообщение об ошибке "Поле пароля не может быть пустым"

@medium @negative
Сценарий: Я оставляю оба поля пустыми
Пусть я открываю сайт "qa-testing.ru"
И оставляю форму логина пустой
И нажимаю "кнопку Войти"
Тогда я вижу сообщение об ошибке "Поля логина и пароля не могут быть пустыми"

@medium @negative
Сценарий: Я ввожу логин без символа '@'
Пусть я открываю сайт "qa-testing.ru"
И заполняю форму логина данными:
| элемент      | значение               |
| логин Email  | test1usertestmail.com  |
| логин Пароль | "BAw23f5m"             |
И нажимаю "кнопку Войти"
Тогда я вижу сообщение об ошибке "Неверный формат email"

@medium @negative
Сценарий: Я ввожу логин с пробелами
Пусть я открываю сайт "qa-testing.ru"
И заполняю форму логина данными:
| элемент      | значение                 |
| логин Email  | "test user@testmail.com" |
| логин Пароль | "BAw23f5m"               |
И нажимаю "кнопку Войти"
Тогда я вижу сообщение об ошибке "Неверный формат email"

@medium @negative
Сценарий: Я ввожу логин с особыми символами
Пусть я открываю сайт "qa-testing.ru"
И заполняю форму логина данными:
| элемент      | значение                  |
| логин Email  | "test!user@testmail.com"  |
| логин Пароль | "BAw23f5m"                |
И нажимаю "кнопку Войти"
Тогда я вижу сообщение об ошибке "Неверный формат email"

@medium @negative
Сценарий: Я ввожу логин минимальной длины
Пусть я открываю сайт "qa-testing.ru"
И заполняю форму логина данными:
| элемент      | значение          |
| логин Email  | "a@b.co"          |
| логин Пароль | "BAw23f5m"        |
И нажимаю "кнопку Войти"
Тогда я вижу сообщение об ошибке "Недопустимая длина поля Логин"

@medium @negative
Сценарий: Я ввожу пароль минимальной длины
Пусть я открываю сайт "qa-testing.ru"
И заполняю форму логина данными:
| элемент      | значение               |
| логин Email  | test1user@testmail.com |
| логин Пароль | "12345"                |
И нажимаю "кнопку Войти"
Тогда я вижу сообщение об ошибке "Недопустимая длина поля Пароль"

@medium @negative
Сценарий: Я ввожу логин максимальной длины
Пусть я открываю сайт "qa-testing.ru"
И заполняю форму логина данными:
| элемент      | значение                                                               |
| логин Email  | "verylongemailaddress12345678901234567890123456789012345@testmail.com" |
| логин Пароль | "BAw23f5m"                                                             |
И нажимаю "кнопку Войти"
Тогда я вижу сообщение об ошибке "Недопустимая длина поля Логин"

@medium @negative
Сценарий: Я ввожу пароль максимальной длины
Пусть я открываю сайт "qa-testing.ru"
И заполняю форму логина данными:
| элемент      | значение               |
| логин Email  | test1user@testmail.com |
| логин Пароль | "BAw23f5mBAw23f5mBAw23f5mBAw23f5mBAw23f5mBAw23f5m" |
И нажимаю "кнопку Войти"
Тогда я вижу сообщение об ошибке "Недопустимая длина поля Пароль"

@medium @negative
Сценарий: Я ввожу логин без точки в домене
Пусть я открываю сайт "qa-testing.ru"
И заполняю форму логина данными:
| элемент      | значение               |
| логин Email  | "test1user@testmailcom"|
| логин Пароль | "BAw23f5m"             |
И нажимаю "кнопку Войти"
Тогда я вижу сообщение об ошибке "Неверный формат email"

@medium @positive
Сценарий: Я многократно нажимаю на кнопку "Войти"
Пусть я открываю сайт "qa-testing.ru"
И заполняю форму логина валидными данными:
| элемент      | значение               |
| логин Email  | test1user@testmail.com |
| логин Пароль | "BAw23f5m"             |
И многократно нажимаю "кнопку Войти"
Тогда я вижу сообщение "Авторизация успешна" только один раз

@medium @positive
Сценарий: Я проверяю сокрытие/показ вводимого пароля
Пусть я открываю сайт "qa-testing.ru"
И начинаю вводить пароль
И нажимаю на иконку "показать пароль"
Тогда я вижу введенный пароль
Когда я нажимаю на иконку "скрыть пароль"
Тогда я вижу, что пароль снова скрыт

@low @positive
Сценарий: Я восстанавливаю пароль
Пусть я открываю сайт "qa-testing.ru"
И нажимаю на ссылку "Забыли пароль?"
И ввожу email "test1user@testmail.com"
И нажимаю "кнопку Восстановить"
Тогда я вижу сообщение "Письмо для восстановления пароля отправлено"

@medium @negative
Сценарий: Я пытаюсь авторизоваться под старым паролем после смены пароля
Пусть я открываю сайт "qa-testing.ru"
И заполняю форму логина данными:
| элемент      | значение               |
| логин Email  | test1user@testmail.com |
| логин Пароль | "oldpassword"          |
И нажимаю "кнопку Войти"
Тогда я вижу сообщение об ошибке "Вы используете старый пароль"

@high @positive
Сценарий: Я прохожу двухфакторную аутентификацию
Пусть я открываю сайт "qa-testing.ru"
И заполняю форму логина валидными данными:
| элемент      | значение               |
| логин Email  | test1user@testmail.com |
| логин Пароль | "BAw23f5m"             |
И нажимаю "кнопку Войти"
Тогда я ввожу код из SMS
И нажимаю "кнопку Подтвердить"
Тогда я понимаю, что авторизован, так как вижу "профиль Пользователя"

@low @positive
Сценарий: Я вставляю текст из буфера обмена
Пусть я открываю сайт "qa-testing.ru"
И вставляю текст в форму логина:
| элемент      | значение               |
| логин Email  | test1user@testmail.com |
| логин Пароль | "BAw23f5m"             |
И нажимаю "кнопку Войти"
Тогда я понимаю, что авторизован, так как вижу "профиль Пользователя"

@critical @negative
Сценарий: Я проверяю защиту от HTML, XSS и SQL-инъекций
Пусть я открываю сайт "qa-testing.ru"
И заполняю форму логина данными:
| элемент      | значение                        |
| логин Email  | "<script>alert('xss')</script>" |
| логин Пароль | "' OR '1'='1"                   |
И нажимаю "кнопку Войти"
Тогда я вижу сообщение об ошибке "Неверный логин или пароль"

@critical @negative
Сценарий: Я блокируюсь после N-попыток неверного входа
Пусть я открываю сайт "qa-testing.ru"
И многократно ввожу неверные данные:
| элемент      | значение               |
| логин Email  | test1user@testmail.com |
| логин Пароль | "wrongpassword"        |
И нажимаю "кнопку Войти" более N раз
Тогда я вижу сообщение "Ваш аккаунт заблокирован. Попробуйте позже."

@medium @positive
Сценарий: Я вхожу через сторонний сервис
Пусть я открываю сайт "qa-testing.ru"
И нажимаю "кнопку Войти через Google"
И я авторизуюсь через Google
Тогда я понимаю, что авторизован, так как вижу "профиль Пользователя"

@medium @positive
Сценарий: Я вхожу с флагом "чужой компьютер"
Пусть я открываю сайт "qa-testing.ru"
И заполняю форму логина валидными данными:
| элемент      | значение               |
| логин Email  | test1user@testmail.com |
| логин Пароль | "BAw23f5m"             |
И ставлю флаг "чужой компьютер"
И нажимаю "кнопку Войти"
Тогда я понимаю, что авторизован, так как вижу "профиль Пользователя", но не вижу опции "запомнить меня"

@medium @positive
Сценарий: Я вхожу с флагом "запомнить пароль"
Пусть я открываю сайт "qa-testing.ru"
И заполняю форму логина валидными данными:
| элемент      | значение               |
| логин Email  | test1user@testmail.com |
| логин Пароль | "BAw23f5m"             |
И ставлю флаг "запомнить пароль"
И нажимаю "кнопку Войти"
Тогда я понимаю, что авторизован, так как вижу "профиль Пользователя"
Тогда я закрываю вкладку сайта
И открываю сайт вновь
Тогда я понимаю, что авторизован и пароль был сохранён, так как вижу "профиль Пользователя"

